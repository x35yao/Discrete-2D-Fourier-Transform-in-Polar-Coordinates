clear
clc
%% Sample the function f(r,theta)=h*g
N2=61; %number of sample points in angular direction
N1=128; %number of sample points in radial direction
M=(N2-1)/2; %highest order of bessel function
R=40;% space limit
Wp=10; % band limit
a=1;
load('zeromatrix.mat')
theta=thetamatrix_SpaceLimited(N2,N1);
r=rmatrix_SpaceLimited(N2,N1,R,zeromatrix);
psi=psimatrix_SpaceLimited(N2,N1);
rho=rhomatrix_SpaceLimited(N2,N1,R,zeromatrix);
[x,y]=pol2cart(theta,r); %sample points in Cartesian coordinates
[x1,y1]=pol2cart(psi,rho);

%dicretizing the function
for ii=1:N2
    for jj=1:N1-1
        f(ii,jj)=(heaviside(r(ii,jj)-5)-heaviside(r(ii,jj)-10))*(heaviside(theta(ii,jj)+pi/2)-heaviside(theta(ii,jj)-pi/2));
    end
end

fnk=circshift(fft(circshift(f,M+1,1),N2,1),-(M+1),1);

for n=-M:M
    ii=n+M+1;
    zero2=zeromatrix(5001-abs(n),:);
    jnN1=zero2(N1);
    if n<0
    Y=((-1)^abs(n))*YmatrixAssembly(abs(n),N1,zero2);
    else
    Y=YmatrixAssembly(abs(n),N1,zero2);
    end
    fnl(ii,:)=(Y*fnk(ii,:)')';
    Fnl(ii,:)=fnl(ii,:)*(2*pi*(i^(-n)))*(R^2/jnN1);
end
TwoDFT=circshift(ifft(circshift(Fnl,M+1,1),N2,1),-(M+1),1);
%creating a discrete true function
for ii=1:N2
    for jj=1:N1-1
        StruveH05=StruveH0(5*rho(ii,jj));
        StruveH15=StruveH1(5*rho(ii,jj));
        StruveH010=StruveH0(10*rho(ii,jj));
        StruveH110=StruveH1(10*rho(ii,jj));
        StruveH110pi=StruveH1(10*pi*rho(ii,jj));
       trueFunc(ii,jj)=((7382910043507654656*i) * cos((19 * psi(ii,jj))) * besselj(1, 10 * rho(ii,jj)) + (-483846392611317655535616*i) * cos((19 * psi(ii,jj))) * besselj(1, 5 * rho(ii,jj)) + (71042651367187500*i) * cos((17 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * pi * besselj(0, 10 * rho(ii,jj)) * StruveH110+ (-71042651367187500*i) * cos((17 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * pi * besselj(1, 10 * rho(ii,jj)) * StruveH010 + (-35521325683593750*i) * cos((7 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * pi * StruveH15* besselj(0, 5 * rho(ii,jj)) + (35521325683593750*i) * cos((7 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * pi * besselj(1, 5 * rho(ii,jj)) * StruveH05 + (71042651367187500*i) * cos((7 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * pi * besselj(0, 10 * rho(ii,jj)) * StruveH110 + (-71042651367187500*i) * cos((7 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * pi * besselj(1, 10 * rho(ii,jj)) * StruveH010 + (-35521325683593750*i) * cos((13 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * pi * StruveH15 * besselj(0, 5 * rho(ii,jj)) + (35521325683593750*i) * cos((13 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * pi * besselj(1, 5 * rho(ii,jj)) * StruveH05+ (71042651367187500*i) * cos((13 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * pi * besselj(0, 10 * rho(ii,jj)) * StruveH110 + (-71042651367187500*i) * cos((13 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * pi * besselj(1, 10 * rho(ii,jj)) * StruveH010 + (-35521325683593750*i) * cos((11 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * pi * StruveH15 * besselj(0, 5 * rho(ii,jj)) + (35521325683593750*i) * cos((11 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * pi * besselj(1, 5 * rho(ii,jj)) * StruveH05+ (71042651367187500*i) * cos((11 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * pi * besselj(0, 10 * rho(ii,jj)) * StruveH110 + (-71042651367187500*i) * cos((11 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * pi * besselj(1, 10 * rho(ii,jj)) * StruveH010 + (-35521325683593750*i) * cos((9 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * pi * StruveH15 * besselj(0, 5 * rho(ii,jj)) + (35521325683593750*i) * cos((9 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * pi * besselj(1, 5 * rho(ii,jj)) * StruveH05+ (71042651367187500*i) * cos((9 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * pi * besselj(0, 10 * rho(ii,jj)) * StruveH110 + (-71042651367187500*i) * cos((9 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * pi * besselj(1, 10 * rho(ii,jj)) * StruveH010 + (-35521325683593750*i) * cos((5 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * pi * StruveH15 * besselj(0, 5 * rho(ii,jj)) + (35521325683593750*i) * cos((5 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * pi * besselj(1, 5 * rho(ii,jj)) * StruveH05+ (71042651367187500*i) * cos((5 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * pi * besselj(0, 10 * rho(ii,jj)) * StruveH110 + (-71042651367187500*i) * cos((5 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * pi * besselj(1, 10 * rho(ii,jj)) * StruveH010 + (-35521325683593750*i) * cos((3 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * pi * StruveH15 * besselj(0, 5 * rho(ii,jj)) + (35521325683593750*i) * cos((3 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * pi * besselj(1, 5 * rho(ii,jj)) * StruveH05+ (71042651367187500*i) * cos((3 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * pi * besselj(0, 10 * rho(ii,jj)) * StruveH110 + (-71042651367187500*i) * cos((3 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * pi * besselj(1, 10 * rho(ii,jj)) * StruveH010 + (-35521325683593750*i) * cos((15 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * pi * StruveH15 * besselj(0, 5 * rho(ii,jj)) + (35521325683593750*i) * cos((15 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * pi * besselj(1, 5 * rho(ii,jj)) * StruveH05+ (71042651367187500*i) * cos((15 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * pi * besselj(0, 10 * rho(ii,jj)) * StruveH110 + (-71042651367187500*i) * cos((15 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * pi * besselj(1, 10 * rho(ii,jj)) * StruveH010 + (-35521325683593750*i) * cos((19 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * pi * StruveH15 * besselj(0, 5 * rho(ii,jj)) + (35521325683593750*i) * cos((19 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * pi * besselj(1, 5 * rho(ii,jj)) * StruveH05+ (71042651367187500*i) * cos((19 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * pi * besselj(0, 10 * rho(ii,jj)) * StruveH110 + (-35521325683593750*i) * cos(psi(ii,jj)) * besselj(0, 5 * rho(ii,jj)) * StruveH15 * pi * (rho(ii,jj) ^ 17) + (35521325683593750*i) * cos(psi(ii,jj)) * besselj(1, 5 * rho(ii,jj)) * StruveH05* pi * (rho(ii,jj) ^ 17) + (71042651367187500*i) * cos(psi(ii,jj)) * pi * StruveH110 * besselj(0, 10 * rho(ii,jj)) * (rho(ii,jj) ^ 17) + (-71042651367187500*i) * cos(psi(ii,jj)) * pi * StruveH010 * besselj(1, 10 * rho(ii,jj)) * (rho(ii,jj) ^ 17) + (-71042651367187500*i) * cos((19 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * pi * besselj(1, 10 * rho(ii,jj)) * StruveH010 + (-35521325683593750*i) * cos((17 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * pi * StruveH15 * besselj(0, 5 * rho(ii,jj)) + (35521325683593750*i) * cos((17 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * pi * besselj(1, 5 * rho(ii,jj)) * StruveH05+ (8322334020000000000*i) * cos((15 * psi(ii,jj))) * (rho(ii,jj) ^ 14) * besselj(1, 5 * rho(ii,jj)) + (-2080583505000000000*i) * cos((15 * psi(ii,jj))) * (rho(ii,jj) ^ 14) * besselj(1, 10 * rho(ii,jj)) + (41204283120000000000*i) * cos((15 * psi(ii,jj))) * (rho(ii,jj) ^ 13) * besselj(0, 5 * rho(ii,jj)) + (-5150535390000000000*i) * cos((15 * psi(ii,jj))) * (rho(ii,jj) ^ 13) * besselj(0, 10 * rho(ii,jj)) + (-160068164256000000000*i) * cos((15 * psi(ii,jj))) * (rho(ii,jj) ^ 12) * besselj(1, 5 * rho(ii,jj)) + (10004260266000000000*i) * cos((15 * psi(ii,jj))) * (rho(ii,jj) ^ 12) * besselj(1, 10 * rho(ii,jj)) + (-455900949504000000000*i) * cos((15 * psi(ii,jj))) * (rho(ii,jj) ^ 11) * besselj(0, 5 * rho(ii,jj)) + (14246904672000000000*i) * cos((15 * psi(ii,jj))) * (rho(ii,jj) ^ 11) * besselj(0, 10 * rho(ii,jj)) + (1092821393664000000000*i) * cos((15 * psi(ii,jj))) * (rho(ii,jj) ^ 10) * besselj(1, 5 * rho(ii,jj)) + (-17075334276000000000*i) * cos((15 * psi(ii,jj))) * (rho(ii,jj) ^ 10) * besselj(1, 10 * rho(ii,jj)) + (1877239203840000000000*i) * cos((15 * psi(ii,jj))) * (rho(ii,jj) ^ 9) * besselj(0, 5 * rho(ii,jj)) + (-14665931280000000000*i) * cos((15 * psi(ii,jj))) * (rho(ii,jj) ^ 9) * besselj(0, 10 * rho(ii,jj)) + (-2823367762575360000000*i) * cos((15 * psi(ii,jj))) * (rho(ii,jj) ^ 8) * besselj(1, 5 * rho(ii,jj)) + (11028780322560000000*i) * cos((15 * psi(ii,jj))) * (rho(ii,jj) ^ 8) * besselj(1, 10 * rho(ii,jj)) + (-2768101840414310400000*i) * cos((15 * psi(ii,jj))) * (rho(ii,jj) ^ 7) * besselj(0, 5 * rho(ii,jj)) + (5406448907059200000*i) * cos((15 * psi(ii,jj))) * (rho(ii,jj) ^ 7) * besselj(0, 10 * rho(ii,jj)) + (2439389746865111040000*i) * cos((15 * psi(ii,jj))) * (rho(ii,jj) ^ 6) * besselj(1, 5 * rho(ii,jj)) + (-2382216549672960000*i) * cos((15 * psi(ii,jj))) * (rho(ii,jj) ^ 6) * besselj(1, 10 * rho(ii,jj)) + (1065719208559509504000*i) * cos((15 * psi(ii,jj))) * (rho(ii,jj) ^ 5) * besselj(0, 5 * rho(ii,jj)) + (-520370707304448000*i) * cos((15 * psi(ii,jj))) * (rho(ii,jj) ^ 5) * besselj(0, 10 * rho(ii,jj)) + (-426287683423803801600*i) * cos((15 * psi(ii,jj))) * (rho(ii,jj) ^ 4) * besselj(1, 5 * rho(ii,jj)) + (-484102710000000000*i) * cos((11 * psi(ii,jj))) * (rho(ii,jj) ^ 13) * besselj(0, 10 * rho(ii,jj)) + (-7009172352000000000*i) * cos((11 * psi(ii,jj))) * (rho(ii,jj) ^ 12) * besselj(1, 5 * rho(ii,jj)) + (438073272000000000*i) * cos((11 * psi(ii,jj))) * (rho(ii,jj) ^ 12) * besselj(1, 10 * rho(ii,jj)) + (-7923412224000000000*i) * cos((11 * psi(ii,jj))) * (rho(ii,jj) ^ 11) * besselj(0, 5 * rho(ii,jj)) + (247606632000000000*i) * cos((11 * psi(ii,jj))) * (rho(ii,jj) ^ 11) * besselj(0, 10 * rho(ii,jj)) + (7435817625600000000*i) * cos((11 * psi(ii,jj))) * (rho(ii,jj) ^ 10) * besselj(1, 5 * rho(ii,jj)) + (-116184650400000000*i) * cos((11 * psi(ii,jj))) * (rho(ii,jj) ^ 10) * besselj(1, 10 * rho(ii,jj)) + (3413162188800000000*i) * cos((11 * psi(ii,jj))) * (rho(ii,jj) ^ 9) * besselj(0, 5 * rho(ii,jj)) + (-26665329600000000*i) * cos((11 * psi(ii,jj))) * (rho(ii,jj) ^ 9) * besselj(0, 10 * rho(ii,jj)) + (-1365264875520000000*i) * cos((11 * psi(ii,jj))) * (rho(ii,jj) ^ 8) * besselj(1, 5 * rho(ii,jj)) + (-15833317500000000000*i) * cos((17 * psi(ii,jj))) * (rho(ii,jj) ^ 14) * besselj(1, 5 * rho(ii,jj)) + (3958329375000000000*i) * cos((17 * psi(ii,jj))) * (rho(ii,jj) ^ 14) * besselj(1, 10 * rho(ii,jj)) + (-103729626000000000000*i) * cos((17 * psi(ii,jj))) * (rho(ii,jj) ^ 13) * besselj(0, 5 * rho(ii,jj)) + (12966203250000000000*i) * cos((17 * psi(ii,jj))) * (rho(ii,jj) ^ 13) * besselj(0, 10 * rho(ii,jj)) + (535614599520000000000*i) * cos((17 * psi(ii,jj))) * (rho(ii,jj) ^ 12) * besselj(1, 5 * rho(ii,jj)) + (-33475912470000000000*i) * cos((17 * psi(ii,jj))) * (rho(ii,jj) ^ 12) * besselj(1, 10 * rho(ii,jj)) + (2094935851008000000000*i) * cos((17 * psi(ii,jj))) * (rho(ii,jj) ^ 11) * besselj(0, 5 * rho(ii,jj)) + (-65466745344000000000*i) * cos((17 * psi(ii,jj))) * (rho(ii,jj) ^ 11) * besselj(0, 10 * rho(ii,jj)) + (-6924094265088000000000*i) * cos((17 * psi(ii,jj))) * (rho(ii,jj) ^ 10) * besselj(1, 5 * rho(ii,jj)) + (108188972892000000000*i) * cos((17 * psi(ii,jj))) * (rho(ii,jj) ^ 10) * besselj(1, 10 * rho(ii,jj)) + (-17363358377164800000000*i) * cos((17 * psi(ii,jj))) * (rho(ii,jj) ^ 9) * besselj(0, 5 * rho(ii,jj)) + (135651237321600000000*i) * cos((17 * psi(ii,jj))) * (rho(ii,jj) ^ 9) * besselj(0, 10 * rho(ii,jj)) + (38223240410234880000000*i) * cos((17 * psi(ii,jj))) * (rho(ii,jj) ^ 8) * besselj(1, 5 * rho(ii,jj)) + (-149309532852480000000*i) * cos((17 * psi(ii,jj))) * (rho(ii,jj) ^ 8) * besselj(1, 10 * rho(ii,jj)) + (61264606909169664000000*i) * cos((17 * psi(ii,jj))) * (rho(ii,jj) ^ 7) * besselj(0, 5 * rho(ii,jj)) + (94723535156250000*i) * cos((3 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * besselj(0, 5 * rho(ii,jj)) + (-189447070312500000*i) * cos((3 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * besselj(0, 10 * rho(ii,jj)) + (-37889414062500000*i) * cos((3 * psi(ii,jj))) * (rho(ii,jj) ^ 16) * besselj(1, 5 * rho(ii,jj)) + (37889414062500000*i) * cos((3 * psi(ii,jj))) * (rho(ii,jj) ^ 16) * besselj(1, 10 * rho(ii,jj)) + (75778828125000000*i) * cos((15 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * besselj(0, 5 * rho(ii,jj)) + (-151557656250000000*i) * cos((15 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * besselj(0, 10 * rho(ii,jj)) + (-121246125000000000*i) * cos((15 * psi(ii,jj))) * (rho(ii,jj) ^ 16) * besselj(1, 5 * rho(ii,jj)) + (121246125000000000*i) * cos((15 * psi(ii,jj))) * (rho(ii,jj) ^ 16) * besselj(1, 10 * rho(ii,jj)) + (-1163962800000000000*i) * cos((15 * psi(ii,jj))) * (rho(ii,jj) ^ 15) * besselj(0, 5 * rho(ii,jj)) + (581981400000000000*i) * cos((15 * psi(ii,jj))) * (rho(ii,jj) ^ 15) * besselj(0, 10 * rho(ii,jj)) + (764026638489354240*i) * cos((17 * psi(ii,jj))) * (rho(ii,jj) ^ 2) * besselj(1, 10 * rho(ii,jj)) + (81191601562500000*i) * cos((7 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * besselj(0, 5 * rho(ii,jj)) + (-162383203125000000*i) * cos((7 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * besselj(0, 10 * rho(ii,jj)) + (-64953281250000000*i) * cos((7 * psi(ii,jj))) * (rho(ii,jj) ^ 16) * besselj(1, 5 * rho(ii,jj)) + (64953281250000000*i) * cos((7 * psi(ii,jj))) * (rho(ii,jj) ^ 16) * besselj(1, 10 * rho(ii,jj)) + (-103925250000000000*i) * cos((7 * psi(ii,jj))) * (rho(ii,jj) ^ 15) * besselj(0, 5 * rho(ii,jj)) + (51962625000000000*i) * cos((7 * psi(ii,jj))) * (rho(ii,jj) ^ 15) * besselj(0, 10 * rho(ii,jj)) + (135102825000000000*i) * cos((7 * psi(ii,jj))) * (rho(ii,jj) ^ 14) * besselj(1, 5 * rho(ii,jj)) + (-33775706250000000*i) * cos((7 * psi(ii,jj))) * (rho(ii,jj) ^ 14) * besselj(1, 10 * rho(ii,jj)) + (74826180000000000*i) * cos((7 * psi(ii,jj))) * (rho(ii,jj) ^ 13) * besselj(0, 5 * rho(ii,jj)) + (-9353272500000000*i) * cos((7 * psi(ii,jj))) * (rho(ii,jj) ^ 13) * besselj(0, 10 * rho(ii,jj)) + (-29930472000000000*i) * cos((7 * psi(ii,jj))) * (rho(ii,jj) ^ 12) * besselj(1, 5 * rho(ii,jj)) + (1870654500000000*i) * cos((7 * psi(ii,jj))) * (rho(ii,jj) ^ 12) * besselj(1, 10 * rho(ii,jj)) + (65577832031250000*i) * cos((13 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * besselj(0, 5 * rho(ii,jj)) + (-131155664062500000*i) * cos((13 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * besselj(0, 10 * rho(ii,jj)) + (78693398437500000*i) * cos((13 * psi(ii,jj))) * (rho(ii,jj) ^ 16) * besselj(1, 5 * rho(ii,jj)) + (-78693398437500000*i) * cos((13 * psi(ii,jj))) * (rho(ii,jj) ^ 16) * besselj(1, 10 * rho(ii,jj)) + (755456625000000000*i) * cos((13 * psi(ii,jj))) * (rho(ii,jj) ^ 15) * besselj(0, 5 * rho(ii,jj)) + (-377728312500000000*i) * cos((13 * psi(ii,jj))) * (rho(ii,jj) ^ 15) * besselj(0, 10 * rho(ii,jj)) + (-3961950300000000000*i) * cos((13 * psi(ii,jj))) * (rho(ii,jj) ^ 14) * besselj(1, 5 * rho(ii,jj)) + (990487575000000000*i) * cos((13 * psi(ii,jj))) * (rho(ii,jj) ^ 14) * besselj(1, 10 * rho(ii,jj)) + (-14074996320000000000*i) * cos((13 * psi(ii,jj))) * (rho(ii,jj) ^ 13) * besselj(0, 5 * rho(ii,jj)) + (1759374540000000000*i) * cos((13 * psi(ii,jj))) * (rho(ii,jj) ^ 13) * besselj(0, 10 * rho(ii,jj)) + (38937241728000000000*i) * cos((13 * psi(ii,jj))) * (rho(ii,jj) ^ 12) * besselj(1, 5 * rho(ii,jj)) + (-2433577608000000000*i) * cos((13 * psi(ii,jj))) * (rho(ii,jj) ^ 12) * besselj(1, 10 * rho(ii,jj)) + (74780133120000000000*i) * cos((13 * psi(ii,jj))) * (rho(ii,jj) ^ 11) * besselj(0, 5 * rho(ii,jj)) + (-2336879160000000000*i) * cos((13 * psi(ii,jj))) * (rho(ii,jj) ^ 11) * besselj(0, 10 * rho(ii,jj)) + (-120163938048000000000*i) * cos((13 * psi(ii,jj))) * (rho(ii,jj) ^ 10) * besselj(1, 5 * rho(ii,jj)) + (1877561532000000000*i) * cos((13 * psi(ii,jj))) * (rho(ii,jj) ^ 10) * besselj(1, 10 * rho(ii,jj)) + (-124186593484800000000*i) * cos((13 * psi(ii,jj))) * (rho(ii,jj) ^ 9) * besselj(0, 5 * rho(ii,jj)) + (970207761600000000*i) * cos((13 * psi(ii,jj))) * (rho(ii,jj) ^ 9) * besselj(0, 10 * rho(ii,jj)) + (5333065920000000*i) * cos((11 * psi(ii,jj))) * (rho(ii,jj) ^ 8) * besselj(1, 10 * rho(ii,jj)) + (63149023437500000*i) * cos((9 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * besselj(0, 5 * rho(ii,jj)) + (-126298046875000000*i) * cos((9 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * besselj(0, 10 * rho(ii,jj)) + (50519218750000000*i) * cos((9 * psi(ii,jj))) * (rho(ii,jj) ^ 16) * besselj(1, 5 * rho(ii,jj)) + (-50519218750000000*i) * cos((9 * psi(ii,jj))) * (rho(ii,jj) ^ 16) * besselj(1, 10 * rho(ii,jj)) + (242492250000000000*i) * cos((9 * psi(ii,jj))) * (rho(ii,jj) ^ 15) * besselj(0, 5 * rho(ii,jj)) + (-121246125000000000*i) * cos((9 * psi(ii,jj))) * (rho(ii,jj) ^ 15) * besselj(0, 10 * rho(ii,jj)) + (-557732175000000000*i) * cos((9 * psi(ii,jj))) * (rho(ii,jj) ^ 14) * besselj(1, 5 * rho(ii,jj)) + (139433043750000000*i) * cos((9 * psi(ii,jj))) * (rho(ii,jj) ^ 14) * besselj(1, 10 * rho(ii,jj)) + (-756575820000000000*i) * cos((9 * psi(ii,jj))) * (rho(ii,jj) ^ 13) * besselj(0, 5 * rho(ii,jj)) + (94571977500000000*i) * cos((9 * psi(ii,jj))) * (rho(ii,jj) ^ 13) * besselj(0, 10 * rho(ii,jj)) + (768215448000000000*i) * cos((9 * psi(ii,jj))) * (rho(ii,jj) ^ 12) * besselj(1, 5 * rho(ii,jj)) + (-48013465500000000*i) * cos((9 * psi(ii,jj))) * (rho(ii,jj) ^ 12) * besselj(1, 10 * rho(ii,jj)) + (372468096000000000*i) * cos((9 * psi(ii,jj))) * (rho(ii,jj) ^ 11) * besselj(0, 5 * rho(ii,jj)) + (-11639628000000000*i) * cos((9 * psi(ii,jj))) * (rho(ii,jj) ^ 11) * besselj(0, 10 * rho(ii,jj)) + (-148987238400000000*i) * cos((9 * psi(ii,jj))) * (rho(ii,jj) ^ 10) * besselj(1, 5 * rho(ii,jj)) + (2327925600000000*i) * cos((9 * psi(ii,jj))) * (rho(ii,jj) ^ 10) * besselj(1, 10 * rho(ii,jj)) + (56834121093750000*i) * cos((5 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * besselj(0, 5 * rho(ii,jj)) + (-113668242187500000*i) * cos((5 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * besselj(0, 10 * rho(ii,jj)) + (22733648437500000*i) * cos((5 * psi(ii,jj))) * (rho(ii,jj) ^ 16) * besselj(1, 5 * rho(ii,jj)) + (-22733648437500000*i) * cos((5 * psi(ii,jj))) * (rho(ii,jj) ^ 16) * besselj(1, 10 * rho(ii,jj)) + (36373837500000000*i) * cos((5 * psi(ii,jj))) * (rho(ii,jj) ^ 15) * besselj(0, 5 * rho(ii,jj)) + (-18186918750000000*i) * cos((5 * psi(ii,jj))) * (rho(ii,jj) ^ 15) * besselj(0, 10 * rho(ii,jj)) + (-14549535000000000*i) * cos((5 * psi(ii,jj))) * (rho(ii,jj) ^ 14) * besselj(1, 5 * rho(ii,jj)) + (3637383750000000*i) * cos((5 * psi(ii,jj))) * (rho(ii,jj) ^ 14) * besselj(1, 10 * rho(ii,jj)) + (-29175646500000000000*i) * cos((19 * psi(ii,jj))) * (rho(ii,jj) ^ 13) * besselj(0, 10 * rho(ii,jj)) + (-1541135756160000000000*i) * cos((19 * psi(ii,jj))) * (rho(ii,jj) ^ 12) * besselj(1, 5 * rho(ii,jj)) + (96320984760000000000*i) * cos((19 * psi(ii,jj))) * (rho(ii,jj) ^ 12) * besselj(1, 10 * rho(ii,jj)) + (-7873465856256000000000*i) * cos((19 * psi(ii,jj))) * (rho(ii,jj) ^ 11) * besselj(0, 5 * rho(ii,jj)) + (246045808008000000000*i) * cos((19 * psi(ii,jj))) * (rho(ii,jj) ^ 11) * besselj(0, 10 * rho(ii,jj)) + (34088758473369600000000*i) * cos((19 * psi(ii,jj))) * (rho(ii,jj) ^ 10) * besselj(1, 5 * rho(ii,jj)) + (-532636851146400000000*i) * cos((19 * psi(ii,jj))) * (rho(ii,jj) ^ 10) * besselj(1, 10 * rho(ii,jj)) + (115928413022822400000000*i) * cos((19 * psi(ii,jj))) * (rho(ii,jj) ^ 9) * besselj(0, 5 * rho(ii,jj)) + (-905690726740800000000*i) * cos((19 * psi(ii,jj))) * (rho(ii,jj) ^ 9) * besselj(0, 10 * rho(ii,jj)) + (-346841876967505920000000*i) * cos((19 * psi(ii,jj))) * (rho(ii,jj) ^ 8) * besselj(1, 5 * rho(ii,jj)) + (1354851081904320000000*i) * cos((19 * psi(ii,jj))) * (rho(ii,jj) ^ 8) * besselj(1, 10 * rho(ii,jj)) + (-801281256016969728000000*i) * cos((19 * psi(ii,jj))) * (rho(ii,jj) ^ 7) * besselj(0, 5 * rho(ii,jj)) + (1565002453158144000000*i) * cos((19 * psi(ii,jj))) * (rho(ii,jj) ^ 7) * besselj(0, 10 * rho(ii,jj)) + (1668086396387957145600000*i) * cos((19 * psi(ii,jj))) * (rho(ii,jj) ^ 6) * besselj(1, 5 * rho(ii,jj)) + (-1628990621472614400000*i) * cos((19 * psi(ii,jj))) * (rho(ii,jj) ^ 6) * besselj(1, 10 * rho(ii,jj)) + (2550995242383499591680000*i) * cos((19 * psi(ii,jj))) * (rho(ii,jj) ^ 5) * besselj(0, 5 * rho(ii,jj)) + (-1245603145695068160000*i) * cos((19 * psi(ii,jj))) * (rho(ii,jj) ^ 5) * besselj(0, 10 * rho(ii,jj)) + (-3575431854232493359104000*i) * cos((19 * psi(ii,jj))) * (rho(ii,jj) ^ 4) * besselj(1, 5 * rho(ii,jj)) + (872908167537229824000*i) * cos((19 * psi(ii,jj))) * (rho(ii,jj) ^ 4) * besselj(1, 10 * rho(ii,jj)) + (-3304043653248581212569600*i) * cos((19 * psi(ii,jj))) * (rho(ii,jj) ^ 3) * besselj(0, 5 * rho(ii,jj)) + (403325641265695948800*i) * cos((19 * psi(ii,jj))) * (rho(ii,jj) ^ 3) * besselj(0, 10 * rho(ii,jj)) + (2833637438209800158576640*i) * cos((19 * psi(ii,jj))) * (rho(ii,jj) ^ 2) * besselj(1, 5 * rho(ii,jj)) + (-172951503796984872960*i) * cos((19 * psi(ii,jj))) * (rho(ii,jj) ^ 2) * besselj(1, 10 * rho(ii,jj)) + (1209615981528294138839040*i) * cos((19 * psi(ii,jj))) * besselj(0, 5 * rho(ii,jj)) * rho(ii,jj) + (-36914550217538273280*i) * cos((19 * psi(ii,jj))) * besselj(0, 10 * rho(ii,jj)) * rho(ii,jj) + (66863671875000000*i) * cos((17 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * besselj(0, 5 * rho(ii,jj)) + (-133727343750000000*i) * cos((17 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * besselj(0, 10 * rho(ii,jj)) + (106981875000000000*i) * cos((17 * psi(ii,jj))) * (rho(ii,jj) ^ 16) * besselj(1, 5 * rho(ii,jj)) + (-106981875000000000*i) * cos((17 * psi(ii,jj))) * (rho(ii,jj) ^ 16) * besselj(1, 10 * rho(ii,jj)) + (1711710000000000000*i) * cos((17 * psi(ii,jj))) * (rho(ii,jj) ^ 15) * besselj(0, 5 * rho(ii,jj)) + (-855855000000000000*i) * cos((17 * psi(ii,jj))) * (rho(ii,jj) ^ 15) * besselj(0, 10 * rho(ii,jj)) + (112056740167680000000*i) * cos((13 * psi(ii,jj))) * (rho(ii,jj) ^ 8) * besselj(1, 5 * rho(ii,jj)) + (-437721641280000000*i) * cos((13 * psi(ii,jj))) * (rho(ii,jj) ^ 8) * besselj(1, 10 * rho(ii,jj)) + (49905682219008000000*i) * cos((13 * psi(ii,jj))) * (rho(ii,jj) ^ 7) * besselj(0, 5 * rho(ii,jj)) + (-97472035584000000*i) * cos((13 * psi(ii,jj))) * (rho(ii,jj) ^ 7) * besselj(0, 10 * rho(ii,jj)) + (-19962272887603200000*i) * cos((13 * psi(ii,jj))) * (rho(ii,jj) ^ 6) * besselj(1, 5 * rho(ii,jj)) + (19494407116800000*i) * cos((13 * psi(ii,jj))) * (rho(ii,jj) ^ 6) * besselj(1, 10 * rho(ii,jj)) + (77501074218750000*i) * cos((11 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * besselj(0, 5 * rho(ii,jj)) + (-155002148437500000*i) * cos((11 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * besselj(0, 10 * rho(ii,jj)) + (-93001289062500000*i) * cos((11 * psi(ii,jj))) * (rho(ii,jj) ^ 16) * besselj(1, 5 * rho(ii,jj)) + (93001289062500000*i) * cos((11 * psi(ii,jj))) * (rho(ii,jj) ^ 16) * besselj(1, 10 * rho(ii,jj)) + (-446406187500000000*i) * cos((11 * psi(ii,jj))) * (rho(ii,jj) ^ 15) * besselj(0, 5 * rho(ii,jj)) + (223203093750000000*i) * cos((11 * psi(ii,jj))) * (rho(ii,jj) ^ 15) * besselj(0, 10 * rho(ii,jj)) + (1646742825000000000*i) * cos((11 * psi(ii,jj))) * (rho(ii,jj) ^ 14) * besselj(1, 5 * rho(ii,jj)) + (-411685706250000000*i) * cos((11 * psi(ii,jj))) * (rho(ii,jj) ^ 14) * besselj(1, 10 * rho(ii,jj)) + (3872821680000000000*i) * cos((11 * psi(ii,jj))) * (rho(ii,jj) ^ 13) * besselj(0, 5 * rho(ii,jj)) + (104074141460889600*i) * cos((15 * psi(ii,jj))) * (rho(ii,jj) ^ 4) * besselj(1, 10 * rho(ii,jj)) + (74781738281250000*i) * cos((19 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * besselj(0, 5 * rho(ii,jj)) + (-149563476562500000*i) * cos((19 * psi(ii,jj))) * (rho(ii,jj) ^ 17) * besselj(0, 10 * rho(ii,jj)) + (-149563476562500000*i) * cos((19 * psi(ii,jj))) * (rho(ii,jj) ^ 16) * besselj(1, 5 * rho(ii,jj)) + (149563476562500000*i) * cos((19 * psi(ii,jj))) * (rho(ii,jj) ^ 16) * besselj(1, 10 * rho(ii,jj)) + (-2393015625000000000*i) * cos((19 * psi(ii,jj))) * (rho(ii,jj) ^ 15) * besselj(0, 5 * rho(ii,jj)) + (1196507812500000000*i) * cos((19 * psi(ii,jj))) * (rho(ii,jj) ^ 15) * besselj(0, 10 * rho(ii,jj)) + (27950422500000000000*i) * cos((19 * psi(ii,jj))) * (rho(ii,jj) ^ 14) * besselj(1, 5 * rho(ii,jj)) + (-6987605625000000000*i) * cos((19 * psi(ii,jj))) * (rho(ii,jj) ^ 14) * besselj(1, 10 * rho(ii,jj)) + (233405172000000000000*i) * cos((19 * psi(ii,jj))) * (rho(ii,jj) ^ 13) * besselj(0, 5 * rho(ii,jj)) + (-119657435369472000000*i) * cos((17 * psi(ii,jj))) * (rho(ii,jj) ^ 7) * besselj(0, 10 * rho(ii,jj)) + (-88370633570726707200000*i) * cos((17 * psi(ii,jj))) * (rho(ii,jj) ^ 6) * besselj(1, 5 * rho(ii,jj)) + (86299446846412800000*i) * cos((17 * psi(ii,jj))) * (rho(ii,jj) ^ 6) * besselj(1, 10 * rho(ii,jj)) + (-83690302554526187520000*i) * cos((17 * psi(ii,jj))) * (rho(ii,jj) ^ 5) * besselj(0, 5 * rho(ii,jj)) + (40864405544202240000*i) * cos((17 * psi(ii,jj))) * (rho(ii,jj) ^ 5) * besselj(0, 10 * rho(ii,jj)) + (72594284912465412096000*i) * cos((17 * psi(ii,jj))) * (rho(ii,jj) ^ 4) * besselj(1, 5 * rho(ii,jj)) + (-17723214089957376000*i) * cos((17 * psi(ii,jj))) * (rho(ii,jj) ^ 4) * besselj(1, 10 * rho(ii,jj)) + (31294531112523949670400*i) * cos((17 * psi(ii,jj))) * (rho(ii,jj) ^ 3) * besselj(0, 5 * rho(ii,jj)) + (-3820133192446771200*i) * cos((17 * psi(ii,jj))) * (rho(ii,jj) ^ 3) * besselj(0, 10 * rho(ii,jj)) + (-12517812445009579868160*i) * cos((17 * psi(ii,jj))) * (rho(ii,jj) ^ 2) * besselj(1, 5 * rho(ii,jj)) + 35521325683593750 * pi * (rho(ii,jj) ^ 17) * besselj(1, 10 * rho(ii,jj)) - 17760662841796875 * pi * (rho(ii,jj) ^ 17) * besselj(1, 5 * rho(ii,jj))) / (rho(ii,jj) ^ 18) / 3552132568359375;
    end
end

%calculating the error from transform and true function using dynamic error
error= 20*log10(abs(trueFunc- TwoDFT)/max(max(abs(TwoDFT))));

figure(1)
subplot(2,1,1)
surf(x1,y1,abs(trueFunc))
title('\fontsize{24}Sampled Continuous Forward Transform')
subplot(2,1,2)
surf(x1,y1,abs(TwoDFT))
title('\fontsize{24}Discrete Forward Transform')

figure(2)

surf(x1,y1,error)
xlabel('x');
ylabel('y');
zlabel('db')
str=sprintf('Error distribution with N2 = %d, N1 = %d,R= %d, a= %d ', N2,N1,R,a);
title(['\fontsize{24}Error distribution with N2=',num2str(N2),', N1=',num2str(N1),', R=',num2str(R), ', Wp=',num2str(Wp)]);

mean1=mean(mean(error));
max1=max(max(error));
